---
import styles from './code.module.css'
import { Code as AstroCode } from 'astro:components'
import config from '/astro.config.mjs'
import type { ComponentProps } from 'astro/types'

export type Props = ComponentProps<typeof AstroCode>
const { code: _code, ...props } = Astro.props

// Clean up code a little bit:
const code = _code
	.split('\n')
	// Remove prettier-ignore comments:
	.filter((line) => !/^\s*\/\/ prettier-ignore\s*$/.test(line))
	.join('\n')
---

<AstroCode
	{...props}
	code={code}
	class:list={[styles.code]}
	theme={config.markdown?.shikiConfig?.theme}
/>
